# 운영체제(Operating System)란
#### 운영체제란 사용자가 컴퓨터를 사용하기 위해 필요한 소프트웨어(사용자가 하드웨어를 직접 사용하는 것은 무리)
#### 컴퓨터를 사용하면서 실행한 모든 프로그램들은 운영체제에서 관리 및 제어
#### 대표적인 운영체제로는 Windows, Linux, MS-DOS, Unix, Max OSX. iOS 등
![oscomm](https://user-images.githubusercontent.com/79031788/173549270-ad6cd7ef-bc01-4460-bc72-271a0dcbe340.png)

# 운영체제의 역할
### 1) 사용자를 위한 역할
#### 운영체제는 사용자에게 시스템을 편리하게 사용할 수 있는 인터페이스 제공(GUI와 CLI를 생각해보자)
![gui](https://user-images.githubusercontent.com/79031788/173550758-6ea3e6da-522f-445d-b246-97c383da2a24.png)
### 2) 하드웨어를 위한 역할
#### 운영체제의 가장 핵심적인 기능은 각종 하드웨어를 관리하는 일 그래서 운영체제를 resource manager라고 부르기도 한다.
#### 즉, 운영체제는 컴퓨터 시스템 내의 자원을 효율적으로 관리하는 역할을 한다.
#### (1) 프로세스 관리
##### 컴퓨터를 사용할때, 브라우저를 사용하면서 다른 작업을 할 수 있는 것은 운영체제 덕분이다.
##### CPU가 하나인 경우 CPU는 한번에 한 프로세스만 처리하지만, 우리가 동시작업한다고 느낄 수 있는 이유는 운영체제에서
##### 적절한 방식으로 프로세스들을 관리해주기 때문(시분할 방식, CPU스케쥴링 등)
#### (2) 메모리 관리
##### 메모리는 CPU가 직접 접근할 수 있는 컴퓨터 내부의 기억 장치이다. 모든 프로그램은 메모리에 올라와서 실행됨. 
##### 오늘날에는 여러 프로그램을 동시에 실행시키기 때문에 메모리 관리를 하지 않으면 프로그램끼리 메모리 침범 이슈와 같은 문제 발생
##### 따라서 이러한 문제 해결을 위해 운영체제에서 메모리를 관리
##### 또한 한정된 메모리 공간을 가지고 어떤 프로그램에 얼마만큼 메모리를 할당해줄 것인지 역시 관리
##### 물리적 메모리 관리 방식으로는 고정 분할 방식, 가변 분할 방식, 가상 메모리 방식 등
#### (3) 하드웨어 관리
##### 운영체제는 사용자의 하드웨어에 대한 직접 접근을 막는다.
##### 예를 들어 사용자가 하드디스크의 특정 영역에 데이터를 직접 저장하려는 경우 중요한 데이터를 덮어써 버릴 위험이 있다.
##### 또한 누군가의 악의적인 공격으로 컴퓨터 시스템에 문제를 일으킬 수 있다.
##### 따라서 운영체제는 하드웨어 관리를 직접 하여 사용자의 실수를 방지하고 고의적인 공격에 대한 방어를 하며 하드 디스크의 많은 파일들을 효율적으로 저장하고 관리해주는 역할도 수행

# 운영체제의 구조
#### 운영체제처럼 큰 규모의 프로그램이 메모리에 모두 올라간다면 한정된 메모리 공간의 낭비가 심하게 된다.
#### 따라서 항상 필요한 부분만을 컴퓨터 전원이 켜짐과 동시에 메모리에 올려놓고 그렇지 않은 부분은 필요할 때만 메모리에 올리게 된다. 
#### 이때 메모리에 항상 상주하는 운영체제의 부분을 커널이라고 합니다. 
#### 커널은 운영체제 코드 중에서도 가장 핵심적인 부분이고 커널 자체를 좁은 의미에서의 운영체제라고 부르기도 한다. 
##### 반면 커널 뿐 아니라 각종 주변 시스템 유틸리티(파일 복사 기능 등)를 포함한 개념이 커다른 의미에서의 운영체제이다.
![운영체제구조](https://user-images.githubusercontent.com/79031788/173553499-c145ab8f-a46c-4cb6-b50c-7085d37c24e0.png)
### 1) 인터페이스
##### 사용자는 커널에 직접 접근할 수 없기 때문에 운영체제가 제공하는 인터페이스를 사용해 커널에 명령을 내려야 한다. 
##### 사용자와 애플리케이션은 인터페이스를 통해 커널에 명령을 전달하고, 인터페이스를 통해 실행결과를 전달받는다. 
##### 운영체제가 제공하는 대표적인 인터페이스가 GUI, CLI가 있다.
### 2) 커널 (프로세스, 메모리, 저장장치를 관리하는 핵심적인 기능)
#### (1) 시스템 호출(System Call)
##### 시스템 호출은 커널이 자신을 보호하기 위해 만든 인터페이스
##### 애플리케이션이 직접 하드웨어 자원에 접근하거나 수정하려 할 때 실수(중요 데이터를 덮어쓴다던지 등)를 할 수 있다. 
##### 이러한 사태를 막기 위해 커널은 시스템 콜이라는 시스템 자원 사용과 관련된 함수를 제공합니다. write(), read(), printf() 같은 것들
##### 즉 애플리케이션이 하드웨어에 접근해야하거나 운영체제가 제공하는 서비스를 이용하기 위해서는 커널 함수를 호출하는 시스템 콜을 사용해야 한다. 
##### 또한 시스템 콜을 제공함으로써 운영체제는 컴퓨터 자원을 보호하게 됩니다.
#### (2) 드라이버
##### 커널과 하드웨어의 인터페이스를 드라이버라고 한다. 
##### 보통 커널은 입출력의 기본적인 부분만 제작하여 마우스, 키보드 같은 하드웨어는 꽂기만 해도 보통 작동하게 된다. 
##### 하지만 복잡한 하드웨어의 경우 하드웨어 제작사가 만든 소프트웨어를 따로 설치하여 사용해야 하는데, 이때 이 소프트웨어를 디바이스 드라이버라고 한다. 
##### 프린터나 스캐너 같은 장비를 구매하면 설치해야하는 디바이스 드라이버라는 프로그램 등이 있다.

# 인터럽트
#### 인터럽트란 하드웨어와 OS간의 상호작용 수단이다
#### 우선 이벤트(일반적으로 I/O)가 발생하면 하드웨어나 소프트웨어로부터 발생한 이터럽트에 의해 신호가 보내진다
#### 하드웨어는 언제든 System bus(main communication path로 주요 요소들과 연결되어 있음)를 통해 CPU에 신호를 보내 인터럽트를 발생시킬 수 있다.
#### 소프트웨어는 시스템 호출(system call)을 통해 인터럽트를 발생시킬 수 있다.
#### 위에서도 언급한 시스템 호출은 사용자 프로그램이 운영체제의 서비스를 받기 위해 커널 함수를 호출하는 것을 의미한다.
#### 소프트 웨어로 생긴 인터럽트는 Trap이라 한다.
## 인터럽트 과정
#### 일반적으로 CPU가 인터럽트되면 즉시 하던 일을 멈추고 고정된 위치(fixed location)으로 execution을 전환한다.
#### (fixed location이란 그 인터럽트에 관한 서비스 루틴의 start address를 말함)
#### 그리고 interrupt service routine이 시작된다.
#### 실행이 완료되면 다시 CPU는 인터럽트 되어서 멈춘 연산을 다시 진행한다.
#### (추가로, 다시 돌아오려면 현재 실행되고 있는 프로그램의 주소를 저장해야 하며, 현재 수행중인 작업을 중단하고 인터럽트가 먼저 작업을 수행)
![interrupt](https://user-images.githubusercontent.com/79031788/173556880-a50eff42-8333-4970-88b5-c4c4e8c3549b.jpg)

## 그림을 통해 살펴보는 인터럽트 실제 수행
#### CPU는 interrupt request line이라는 것을 가지고 있다.
#### CPU에서 controller가 이 line을 통해 신호 보낸 것을 감지하면, interrupt number를 읽고, interrupt handler routine으로 점프한다.
#### interrupt handler는 지금의 상태를 저장하고, interrupt의 원인을 알아내고, 필요한 수행을 하고, 다시 CPU에게 processor state를 interrupt 전과 같이 반환한다.
![13_03_Interrupt_IO](https://user-images.githubusercontent.com/79031788/173557778-59544930-7ec7-4b4f-a047-dae58b319376.jpg)
#### 1. 프로그램이 OS에게 I/O Controller에게 정보를 보내라고 인터럽트(Trap)
#### 2~3. Controller가 해당 요청을 받아서 I/O받음
#### 4. I/O 끝나면 요처이 끝났기에 인터럽트(HardWare)
#### 5. CPU가 인터럽트를 받고 handler에게 전달
#### 6~7. 해당 routine이 끝나면 CPU가 다시 작업
